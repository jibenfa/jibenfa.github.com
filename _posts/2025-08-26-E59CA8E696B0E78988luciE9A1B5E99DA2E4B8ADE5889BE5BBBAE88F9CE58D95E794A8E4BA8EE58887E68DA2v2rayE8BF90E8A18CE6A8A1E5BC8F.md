---
id: 826
title: 在新版luci页面中创建菜单用于切换v2ray运行模式
date: 2025-08-26 00:12:13+00:00
author: coffeecat
layout: post
categories:
- 科学上网
tags:
- luci
- lua
- openwrt
---

从 OpenWrt 22.x 开始，LuCI 的实现逐渐从 Lua 迁移到 ubus + ucode + JavaScript (client-side JS)：

旧版 (≤21.02)
```vim
/usr/lib/lua/luci/      ← 主要的 Lua MVC 框架代码
/usr/lib/lua/luci/controller/
/usr/lib/lua/luci/model/
/usr/lib/lua/luci/view/
```
新版 (22.03 / 23.05 / 24.x)
```vim
/usr/libexec/rpcd/                ← rpcd 插件（C/ucode 写的）
/www/luci-static/resources/       ← 前端 JS/HTML/CSS 资源
/usr/share/luci/menu.d/           ← 网页菜单
/usr/share/rpcd/acl.d/            ← ACL 权限 JSON 定义
```
所以很多luci-app-xxx的图形界面软件包都失效了，为了能够在菜单中灵活切换v2ray的运行模式，进行了相关研究。
1)创建菜单页面
vi /usr/share/luci/menu.d/luci-app-advancedconfig.json
2)创建网页脚本
vi /www/luci-static/resources/view/advancedconfig.js
3)创建权限json
vi /usr/share/rpcd/acl.d/luci-app-advancedconfig.json



